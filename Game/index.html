<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Space Shooter</title>
<style>
* {margin:0;padding:0;box-sizing:border-box;}
body {
  background:black;
  overflow:hidden;
  font-family:'Orbitron',sans-serif;
  color:white;
}
#hud {
  position:fixed;
  top:10px;
  left:0;right:0;
  text-align:center;
  font-size:20px;
  color:#00eaff;
}
#btnStart {
  position:fixed;
  top:50%;left:50%;
  transform:translate(-50%,-50%);
  background:#0077ff;
  border:none;
  color:white;
  font-size:22px;
  padding:15px 30px;
  border-radius:10px;
  cursor:pointer;
  box-shadow:0 0 15px #0077ff;
}
#btnStart:hover {background:#0099ff;}
canvas {display:block;margin:auto;background:black;}
</style>
</head>
<body>
<canvas id="game"></canvas>
<div id="hud">Очки: <span id="score">0</span></div>
<button id="btnStart">Начать игру</button>

<script>
// === Инициализация ===
const canvas = document.getElementById("game");
const ctx = canvas.getContext("2d");
const btnStart = document.getElementById("btnStart");
const scoreEl = document.getElementById("score");
let w,h;
function resize(){w=canvas.width=innerWidth;h=canvas.height=innerHeight;}
resize();window.addEventListener("resize",resize);

let stars=[],player,bullets=[],enemies=[],score=0,keys={},running=false;

// === Фоновые звёзды ===
for(let i=0;i<100;i++){
  stars.push({x:Math.random()*w,y:Math.random()*h,s:Math.random()*2});
}

// === Текстуры ===
const imgPlayer=new Image();
imgPlayer.src="data:image/svg+xml;base64,"+btoa(`<svg xmlns='http://www.w3.org/2000/svg' width='50' height='50'><polygon points='25,0 0,50 50,50' fill='#00eaff'/></svg>`);
const imgEnemy=new Image();
imgEnemy.src="data:image/svg+xml;base64,"+btoa(`<svg xmlns='http://www.w3.org/2000/svg' width='40' height='40'><circle cx='20' cy='20' r='18' fill='#ff1744'/></svg>`);
const imgBullet=new Image();
imgBullet.src="data:image/svg+xml;base64,"+btoa(`<svg xmlns='http://www.w3.org/2000/svg' width='8' height='20'><rect width='8' height='20' fill='#ffeb3b'/></svg>`);

// === Классы ===
class Player{
  constructor(){this.x=w/2;this.y=h-80;this.w=50;this.h=50;this.speed=7;}
  draw(){ctx.drawImage(imgPlayer,this.x-this.w/2,this.y-this.h/2,this.w,this.h);}
  move(){
    if(keys["ArrowLeft"]&&this.x>this.w/2)this.x-=this.speed;
    if(keys["ArrowRight"]&&this.x<w-this.w/2)this.x+=this.speed;
  }
}
class Bullet{
  constructor(x,y){this.x=x;this.y=y;this.speed=10;}
  update(){this.y-=this.speed;}
  draw(){ctx.drawImage(imgBullet,this.x-4,this.y-10);}
}
class Enemy{
  constructor(){this.x=Math.random()*(w-60)+30;this.y=-50;this.speed=1.2+Math.random()*1;}
  update(){this.y+=this.speed;}
  draw(){ctx.drawImage(imgEnemy,this.x-20,this.y-20);}
}

// === Функции ===
function spawnEnemy(){if(running)enemies.push(new Enemy());}
setInterval(spawnEnemy,1000);

function drawStars(){
  ctx.fillStyle="white";
  for(let s of stars){
    ctx.fillRect(s.x,s.y,s.s,s.s);
    s.y+=s.s*0.5;
    if(s.y>h)s.y=0;
  }
}

function gameLoop(){
  if(!running)return;
  ctx.clearRect(0,0,w,h);
  drawStars();
  player.move();
  player.draw();
  bullets.forEach((b,i)=>{
    b.update();b.draw();
    if(b.y<0)bullets.splice(i,1);
  });
  enemies.forEach((e,ei)=>{
    e.update();e.draw();
    if(e.y>h)enemies.splice(ei,1);
  });

  // Столкновения
  enemies.forEach((e,ei)=>{
    bullets.forEach((b,bi)=>{
      if(Math.hypot(e.x-b.x,e.y-b.y)<25){
        enemies.splice(ei,1);bullets.splice(bi,1);
        score++;scoreEl.textContent=score;
      }
    });
    if(Math.hypot(e.x-player.x,e.y-player.y)<40){endGame();}
  });
  requestAnimationFrame(gameLoop);
}

function startGame(){
  score=0;scoreEl.textContent=score;
  enemies=[];bullets=[];
  player=new Player();
  running=true;
  btnStart.style.display="none";
  gameLoop();
}
function endGame(){
  running=false;
  ctx.fillStyle="rgba(0,0,0,0.7)";
  ctx.fillRect(0,0,w,h);
  ctx.fillStyle="white";
  ctx.font="40px Orbitron";
  ctx.fillText("Игра окончена!",w/2-150,h/2);
  btnStart.style.display="block";
}

// === Управление ===
document.addEventListener("keydown",e=>{
  keys[e.key]=true;
  if(e.key===" ")bullets.push(new Bullet(player.x,player.y-30));
});
document.addEventListener("keyup",e=>keys[e.key]=false);
btnStart.addEventListener("click",startGame);
</script>
</body>
</html>
